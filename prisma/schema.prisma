generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id         String     @id @default(cuid())
  name       String
  email      String     @unique
  phone      String?
  role       UserRole   @default(customer)
  createdAt  DateTime   @default(now()) @db.Timestamptz(6)
  updatedAt  DateTime   @db.Timestamptz(6)
  auth_links AuthLink[]

  @@map("users")
}

model AuthLink {
  id        String    @id @default(cuid())
  code      String    @unique
  userId    String
  createdAt DateTime  @default(now()) @db.Timestamptz(6)
  expiresAt DateTime  @db.Timestamptz(6)
  usedAt    DateTime? @db.Timestamptz(6)
  users     User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, createdAt], map: "auth_links_user_created_idx")
  @@map("auth_links")
}

enum UserRole {
  manager
  customer

  @@map("user_role")
}
